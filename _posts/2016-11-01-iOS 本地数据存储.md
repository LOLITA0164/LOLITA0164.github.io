---
layout:     post
title:      iOS 本地数据存储
date:       2016-11-01
author:     LOLITA0164
header-img: img/post-bg-dataStorage.jpg
catalog: true
tags:
    - iOS
---

## iOS数据存储特性
### sandbox沙盒

每个 iOS 应用程序都有自己的应用沙盒，可以将沙盒简单的理解为应用的文件夹，每个应用的沙盒都是相互独立的，其他应用不能访问该沙盒，他也不能访问其他应用的沙盒。

#### 沙盒的结构与用途

- **Documents**：保存应用运行时生成的**需要持久化的数据**，iTunes同步设备时**会备份**该目录。重要数据
- **Library/Caches**：保存应用运行时生成的**需要持久化的数据**，iTunes同步设备**不会备份**该目录。非重要数据
- **Library/Preference**：保存应用的**偏好设置**，iTunes同步设备时**会备份**该目录。
- **tmp**：保存应用运行时所需的**临时数据**，使用完毕后再将相应的文件从该目录删除。应用没有运行时，系统也可能会清除该目录下的文件。iTunes同步设备时**不会备份**该目录。

#### 沙盒目录的获取方式

**Documents文件夹的获取方式**

```
// 利用沙盒根目录拼接字符串
NSString *homePath = NSHomeDirectory();
NSString *docPath = [homePath stringByAppendingString:@"/Documents"];
```
```
// 利用沙盒根目录拼接”Documents”字符串
NSString *homePath = NSHomeDirectory();
NSString *docPath = [homePath stringByAppendingPathComponent:@"Documents"];
```
```
// NSDocumentDirectory 要查找的文件
// NSUserDomainMask 代表从用户文件夹下找
// 在iOS中，只有一个目录跟传入的参数匹配，所以这个集合里面只有一个元素
NSString *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)[0];
NSString *filePath = [path stringByAppendingPathComponent:@"xxx.plist"];
```

这里的参数说明一下：
第一个参数：枚举类型，常用的有

- NSDocumentDirectory（Documents文件夹）
- NSCachesDirectory（Library/Caches）

第二个参数：NSUserDomainMask，表示从用户文件夹下找。
第三个参数：打印的路径会是这种形式~/Documents，我们一般都会用YES，这样可以获取完整路径字符串。
这个方法的返回值是一个数组，但在iOS中，只有一个目录跟传入的参数匹配，所以这个集合里面只有一个元素，所以我们取第一个元素
 
**Library/Caches文件夹的获取方式**

```
NSString *path = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES)[0];
NSString *filePath = [path stringByAppendingPathComponent:@"student.data"];
```

**tmp文件夹的获取方式**

```
NSString *tmp= NSTemporaryDirectory();
```

**Library/Preference文件夹的获取方式**
通过 **NSUserDefaults** 类存取该目录下的设置信息


